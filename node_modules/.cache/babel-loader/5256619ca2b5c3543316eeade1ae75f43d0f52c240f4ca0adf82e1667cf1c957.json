{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import TextField from\"@mui/material/TextField\";import Button from\"@mui/material/Button\";import Avatar from\"@mui/material/Avatar\";import CircularProgress from\"@mui/material/CircularProgress\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const UserInfo=()=>{const navigate=useNavigate();const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[userData,setUserData]=useState({exs_nom:\"\",exs_prenom:\"\",exs_photo:\"\",exs_email:\"\",exs_description:\"\"});const[newAvatar,setNewAvatar]=useState(null);// Nouvelle image sélectionnée\n// Fonction pour récupérer les données de l'utilisateur depuis l'API\nconst fetchUserData=async()=>{try{const response=await fetch(\"/user/info\",{headers:{accessToken:sessionStorage.getItem(\"accessToken\")}});if(!response.ok){throw new Error(\"Erreur lors de la récupération des données\");}const jsonData=await response.json();setUserData(jsonData);}catch(error){console.error(\"Erreur lors de la récupération des données:\",error.message);setError(error.message);}finally{setLoading(false);}};useEffect(()=>{fetchUserData();},[]);// Fonction pour mettre à jour les données utilisateur modifiées et les envoyer à l'API\nconst handleSave=async()=>{try{const formData=new FormData();formData.append(\"exs_photo\",newAvatar);// Ajouter la nouvelle image au FormData\nformData.append(\"exs_nom\",userData.exs_nom);formData.append(\"exs_prenom\",userData.exs_prenom);formData.append(\"exs_email\",userData.exs_email);formData.append(\"exs_description\",userData.exs_description);const response=await fetch(\"/user/updateinfo\",{method:\"PUT\",headers:{accessToken:sessionStorage.getItem(\"accessToken\")},body:formData});if(!response.ok){throw new Error(\"Erreur lors de la mise à jour des données\");}alert(\"Données mises à jour avec succès !\");}catch(error){console.error(\"Erreur lors de la mise à jour des données:\",error.message);setError(error.message);}};// Fonction pour gérer le chargement de la nouvelle image sélectionnée\nconst handleFileChange=e=>{const file=e.target.files[0];setNewAvatar(file);};// Affichage d'un indicateur de chargement pendant le chargement des données\nif(loading){return/*#__PURE__*/_jsx(CircularProgress,{});}if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Erreur: \",error]});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"20px\",backgroundColor:\"rgba(255, 255, 255, 0.8)\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Avatar,{alt:\"Avatar\",src:\"/images/\"+userData.exs_photo,sx:{width:100,height:100,margin:\"10px\"}}),/*#__PURE__*/_jsxs(Button,{variant:\"contained\",component:\"label\",children:[\"Modifier votre image\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileChange,style:{display:\"none\"}})]})]}),/*#__PURE__*/_jsx(TextField,{label:\"Nom\",value:userData.exs_nom,onChange:e=>setUserData({...userData,exs_nom:e.target.value}),fullWidth:true,margin:\"normal\"}),/*#__PURE__*/_jsx(TextField,{label:\"Pr\\xE9nom\",value:userData.exs_prenom,onChange:e=>setUserData({...userData,exs_prenom:e.target.value}),fullWidth:true,margin:\"normal\"}),/*#__PURE__*/_jsx(TextField,{label:\"Adresse email\",value:userData.exs_email,onChange:e=>setUserData({...userData,exs_email:e.target.value}),fullWidth:true,margin:\"normal\"}),/*#__PURE__*/_jsx(TextField,{label:\"Description\",value:userData.exs_description,onChange:e=>setUserData({...userData,exs_description:e.target.value}),fullWidth:true,margin:\"normal\",multiline:true,rows:4}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleSave,children:\"Enregistrer\"})]});};export default UserInfo;","map":{"version":3,"names":["React","useState","useEffect","TextField","Button","Avatar","CircularProgress","useNavigate","jsx","_jsx","jsxs","_jsxs","UserInfo","navigate","loading","setLoading","error","setError","userData","setUserData","exs_nom","exs_prenom","exs_photo","exs_email","exs_description","newAvatar","setNewAvatar","fetchUserData","response","fetch","headers","accessToken","sessionStorage","getItem","ok","Error","jsonData","json","console","message","handleSave","formData","FormData","append","method","body","alert","handleFileChange","e","file","target","files","children","style","padding","backgroundColor","alt","src","sx","width","height","margin","variant","component","type","accept","onChange","display","label","value","fullWidth","multiline","rows","color","onClick"],"sources":["C:/Users/abdou/Documents/S9-S10/ProjetFinDetudes/Jalon3/v2/demo - Copie/server/client/src/Components/Utilisateurs/ProfilExStudent/UserInfo.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport TextField from \"@mui/material/TextField\";\r\nimport Button from \"@mui/material/Button\";\r\nimport Avatar from \"@mui/material/Avatar\";\r\nimport CircularProgress from \"@mui/material/CircularProgress\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst UserInfo = () => {\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [userData, setUserData] = useState({\r\n    exs_nom: \"\",\r\n    exs_prenom: \"\",\r\n    exs_photo: \"\",\r\n    exs_email: \"\",\r\n    exs_description: \"\",\r\n  });\r\n  const [newAvatar, setNewAvatar] = useState(null); // Nouvelle image sélectionnée\r\n\r\n  // Fonction pour récupérer les données de l'utilisateur depuis l'API\r\n  const fetchUserData = async () => {\r\n    try {\r\n      const response = await fetch(\"/user/info\", {\r\n        headers: {\r\n          accessToken: sessionStorage.getItem(\"accessToken\"),\r\n        },\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error(\"Erreur lors de la récupération des données\");\r\n      }\r\n      const jsonData = await response.json();\r\n      setUserData(jsonData);\r\n    } catch (error) {\r\n      console.error(\r\n        \"Erreur lors de la récupération des données:\",\r\n        error.message\r\n      );\r\n      setError(error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  // Fonction pour mettre à jour les données utilisateur modifiées et les envoyer à l'API\r\n  const handleSave = async () => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"exs_photo\", newAvatar); // Ajouter la nouvelle image au FormData\r\n      formData.append(\"exs_nom\", userData.exs_nom);\r\n      formData.append(\"exs_prenom\", userData.exs_prenom);\r\n      formData.append(\"exs_email\", userData.exs_email);\r\n      formData.append(\"exs_description\", userData.exs_description);\r\n\r\n      const response = await fetch(\"/user/updateinfo\", {\r\n        method: \"PUT\",\r\n        headers: {\r\n          accessToken: sessionStorage.getItem(\"accessToken\"),\r\n        },\r\n        body: formData,\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error(\"Erreur lors de la mise à jour des données\");\r\n      }\r\n      alert(\"Données mises à jour avec succès !\");\r\n    } catch (error) {\r\n      console.error(\r\n        \"Erreur lors de la mise à jour des données:\",\r\n        error.message\r\n      );\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  // Fonction pour gérer le chargement de la nouvelle image sélectionnée\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    setNewAvatar(file);\r\n  };\r\n\r\n  // Affichage d'un indicateur de chargement pendant le chargement des données\r\n  if (loading) {\r\n    return <CircularProgress />;\r\n  }\r\n\r\n  if (error) {\r\n    return <div>Erreur: {error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      style={{ padding: \"20px\", backgroundColor: \"rgba(255, 255, 255, 0.8)\" }}\r\n    >\r\n      <div>\r\n        <Avatar\r\n          alt=\"Avatar\"\r\n          src={\"/images/\" + userData.exs_photo}\r\n          sx={{ width: 100, height: 100, margin: \"10px\" }}\r\n        />\r\n        <Button variant=\"contained\" component=\"label\">\r\n          Modifier votre image\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            onChange={handleFileChange}\r\n            style={{ display: \"none\" }}\r\n          />\r\n        </Button>\r\n      </div>\r\n      <TextField\r\n        label=\"Nom\"\r\n        value={userData.exs_nom}\r\n        onChange={(e) => setUserData({ ...userData, exs_nom: e.target.value })}\r\n        fullWidth\r\n        margin=\"normal\"\r\n      />\r\n      <TextField\r\n        label=\"Prénom\"\r\n        value={userData.exs_prenom}\r\n        onChange={(e) =>\r\n          setUserData({ ...userData, exs_prenom: e.target.value })\r\n        }\r\n        fullWidth\r\n        margin=\"normal\"\r\n      />\r\n      <TextField\r\n        label=\"Adresse email\"\r\n        value={userData.exs_email}\r\n        onChange={(e) =>\r\n          setUserData({ ...userData, exs_email: e.target.value })\r\n        }\r\n        fullWidth\r\n        margin=\"normal\"\r\n      />\r\n      <TextField\r\n        label=\"Description\"\r\n        value={userData.exs_description}\r\n        onChange={(e) =>\r\n          setUserData({ ...userData, exs_description: e.target.value })\r\n        }\r\n        fullWidth\r\n        margin=\"normal\"\r\n        multiline\r\n        rows={4}\r\n      />\r\n      <Button variant=\"contained\" color=\"primary\" onClick={handleSave}>\r\n        Enregistrer\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserInfo;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}